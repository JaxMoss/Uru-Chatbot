exports.id=807,exports.ids=[807],exports.modules={8950:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{H:()=>u,a:()=>d});var n=a(997),s=a(6689),o=a(2894),l=a(3986),c=e([o]);o=(c.then?(await c)():c)[0];let i=(0,s.createContext)(void 0),u=({children:e})=>{let[t,a]=(0,s.useState)(!1),[r,c]=(0,s.useState)(!1),[u,d]=(0,s.useState)(null);(0,s.useEffect)(()=>{a(!!localStorage.getItem("token"))},[]);let h=(0,s.useCallback)(async(e,t)=>{c(!0),d(null);try{let r=await o.h.login(e,t);return localStorage.setItem("token",r.access_token),localStorage.setItem("userId",e),a(!0),c(!1),!0}catch(e){return d(e.response?.data?.detail||"Login failed"),c(!1),!1}},[]),p=(0,s.useCallback)(async(e,t)=>{c(!0),d(null);try{return await o.h.register(e,t),await h(e,t)}catch(e){return d(e.response?.data?.detail||"Registration failed"),c(!1),!1}},[h]),v=(0,s.useCallback)(()=>{localStorage.removeItem("token"),localStorage.removeItem("userId"),(0,l.mS)(),a(!1)},[]),y=(0,s.useCallback)(async e=>{c(!0),d(null);try{let t=await o.h.validateApiKey(e);if(t.valid)return(0,l.n4)(e),c(!1),!0;return d("Invalid API key"),c(!1),!1}catch(e){return d(e.response?.data?.detail||"Failed to validate API key"),c(!1),!1}},[]),g=(0,s.useCallback)(()=>!!(0,l.Pi)(),[]),m={isAuthenticated:t,isLoading:r,error:u,login:h,register:p,logout:v,setApiKey:y,hasApiKey:g,clearApiKey:l.mS};return n.jsx(i.Provider,{value:m,children:e})},d=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e};r()}catch(e){r(e)}})},8162:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{R:()=>h,a:()=>d});var n=a(997),s=a(6689),o=a(3986),l=a(1418),c=a(2894),i=e([c]);c=(i.then?(await i)():i)[0];let u=(0,s.createContext)(void 0),d=({children:e})=>{let[t,a]=(0,s.useState)([]),[r,i]=(0,s.useState)(null),[d,h]=(0,s.useState)(!1),[p,v]=(0,s.useState)(null),y=(0,s.useCallback)(e=>{if(r)try{let t=JSON.parse(e);i(e=>{if(!e)return null;let a=[...e.messages],r=a[a.length-1];return r&&"assistant"===r.role?a[a.length-1]={...r,content:r.content+t.content}:a.push({role:"assistant",content:t.content}),{...e,messages:a}})}catch(e){console.error("Failed to parse SSE message:",e)}},[r]),{connect:g,disconnect:m}=(0,l.D)({url:`https://api.jackson-test.uruenterprises.com/chat/stream?conversationId=${r?.id||""}`,onMessage:y,onError:e=>{v("Connection error: Please try again"),h(!1)},onComplete:()=>{h(!1)}}),w=(0,s.useCallback)(async()=>{try{let e=await c.h.getConversations();a(e)}catch(e){v("Failed to load conversations")}},[]),C=(0,s.useCallback)(async e=>{h(!0),v(null);try{let t=await c.h.createConversation(e);a(e=>[t,...e]),i({...t,messages:[]}),h(!1)}catch(e){v("Failed to create conversation"),h(!1)}},[]),f=(0,s.useCallback)(async e=>{h(!0),v(null);try{let t=await c.h.getConversation(e);i({...t,messages:[]}),h(!1)}catch(e){v("Failed to load conversation"),h(!1)}},[]),k=(0,s.useCallback)(async e=>{if(!r)return;h(!0),v(null);let t=(0,o.Pi)();if(!t){v("API key not found. Please add your OpenAI API key in settings."),h(!1);return}let a={role:"user",content:e};i(e=>e?{...e,messages:[...e.messages,a]}:null);try{await c.h.sendMessage(r.id,e,t,r.model),g()}catch(e){v("Failed to send message"),h(!1)}},[r,g]),S=(0,s.useCallback)(async(e,t)=>{try{await c.h.updateConversation(e,{title:t}),a(a=>a.map(a=>a.id===e?{...a,title:t}:a)),r?.id===e&&i(e=>e?{...e,title:t}:null)}catch(e){v("Failed to update conversation title")}},[r]),I=(0,s.useCallback)(async e=>{try{await c.h.deleteConversation(e),a(t=>t.filter(t=>t.id!==e)),r?.id===e&&i(null)}catch(e){v("Failed to delete conversation")}},[r]),b=(0,s.useCallback)(async e=>{if(r)try{await c.h.updateConversation(r.id,{model:e}),i(t=>t?{...t,model:e}:null)}catch(e){v("Failed to change model")}},[r]);return(0,s.useEffect)(()=>{w()},[w]),(0,s.useEffect)(()=>()=>{m()},[m]),n.jsx(u.Provider,{value:{conversations:t,currentConversation:r,isLoading:d,error:p,createConversation:C,selectConversation:f,sendMessage:k,updateConversationTitle:S,deleteConversation:I,changeModel:b},children:e})},h=()=>{let e=(0,s.useContext)(u);if(void 0===e)throw Error("useChat must be used within a ChatProvider");return e};r()}catch(e){r(e)}})},1418:(e,t,a)=>{"use strict";a.d(t,{D:()=>n});var r=a(6689);let n=({url:e,onMessage:t,onError:a,onComplete:n,headers:s={},withCredentials:o=!0})=>{let[l,c]=(0,r.useState)(!1),[i,u]=(0,r.useState)(null),d=(0,r.useRef)(null),h=(0,r.useRef)(0),p=(0,r.useCallback)(()=>{d.current&&(d.current.close(),d.current=null,c(!1))},[]),v=(0,r.useCallback)(()=>{p();try{let r=new EventSource(e,{withCredentials:o});d.current=r,r.onopen=()=>{c(!0),h.current=0,u(null)},r.onerror=e=>{if(u(e),c(!1),h.current<5){let e=1e3*Math.pow(2,h.current);h.current+=1,setTimeout(()=>{d.current===r&&v()},e)}else a&&a(e)},r.addEventListener("message",e=>{t(e.data)}),r.addEventListener("complete",()=>{n&&n(),p()}),r.addEventListener("error",e=>{if(e.data)try{let t=JSON.parse(e.data);a&&a(new ErrorEvent("error",{message:t.message}))}catch(t){a&&a(e)}else a&&a(e);p()})}catch(e){console.error("Failed to establish SSE connection:",e),u(e)}},[e,t,a,n,p,o]);return(0,r.useEffect)(()=>()=>{p()},[p]),{isConnected:l,error:i,connect:v,disconnect:p}}},2894:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{h:()=>c});var n=a(9648),s=e([n]);n=(s.then?(await s)():s)[0];let o="https://api.jackson-test.uruenterprises.com";o||console.error("NEXT_PUBLIC_API_URL is not defined");let l=n.default.create({baseURL:o,headers:{"Content-Type":"application/json"},timeout:1e4});l.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>(console.error("API Request Error:",e),Promise.reject(e))),l.interceptors.response.use(e=>e,e=>{if(console.error("API Response Error:",e),!e.response)return console.error("Network Error - Unable to reach the server"),Promise.reject(Error("Unable to connect to the server. Please check your internet connection."));401===e.response.status&&(localStorage.removeItem("token"),localStorage.removeItem("userId"),window.location.href="/login");let t=e.response?.data?.detail||"An unexpected error occurred";return Promise.reject(Error(t))});let c={login:async(e,t)=>{let a=new FormData;a.append("username",e),a.append("password",t);let r=await l.post("/auth/login",a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});return r.data},register:async(e,t)=>{let a=await l.post("/auth/register",{email:e,password:t});return a.data},getConversations:async()=>{let e=await l.get("/conversations");return e.data},getConversation:async e=>{let t=await l.get(`/conversations/${e}`);return t.data},createConversation:async e=>{let t=await l.post("/conversations",{title:"New conversation",model:e});return t.data},updateConversation:async(e,t)=>{let a=await l.patch(`/conversations/${e}`,t);return a.data},deleteConversation:async e=>{let t=await l.delete(`/conversations/${e}`);return t.data},sendMessage:async(e,t,a,r)=>{let n=await l.post("/chat/message",{conversationId:e,message:t,apiKey:a,model:r});return n.data},validateApiKey:async e=>{let t=await l.post("/chat/validate-key",{apiKey:e});return t.data},get:async e=>{let t=await l.get(e);return t},post:async(e,t)=>{let a=await l.post(e,t);return a},patch:async(e,t)=>{let a=await l.patch(e,t);return a},delete:async e=>{let t=await l.delete(e);return t}};r()}catch(e){r(e)}})},3986:(e,t,a)=>{"use strict";a.d(t,{Pi:()=>n,mS:()=>s,n4:()=>r}),a(5666);let r=e=>{},n=()=>null,s=()=>{}},4807:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>i});var n=a(997);a(6689);var s=a(1163),o=a(8950),l=a(8162);a(108);var c=e([o,l]);[o,l]=c.then?(await c)():c;let i=function({Component:e,pageProps:t}){return(0,s.useRouter)(),n.jsx(o.H,{children:n.jsx(l.a,{children:n.jsx(e,{...t})})})};r()}catch(e){r(e)}})},108:()=>{}};